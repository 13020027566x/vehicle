(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d212fb9"],{ab79:function(t,e,o){"use strict";o.r(e);o("55dd"),o("7f7f");var a=function(){var t=this,e=t._self._c;return e("div",[e("Card",{attrs:{"dis-hover":!0}},[e("Row",[e("Col",{attrs:{span:"8"}},[t.options.add?e("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleAddButtonClick()}}},[t._v("\n        新增\n      ")]):t._e(),t.options.remove?e("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small",disabled:t.options.removeDisabled},on:{click:function(e){return t.handleRemoveButtonClick()}}},[t._v("\n        删除\n      ")]):t._e(),e("RemoveModal",{attrs:{modal:t.modal.remove,id:t.modal.id},on:{"on-modal-change":t.handleRemoveModalChange,"on-refresh-page":function(e){return t.handleRefreshChange(!0)}}}),e("Tree",{ref:"organizationTree",attrs:{data:t.organizationStore.items,"empty-text":t.options.page?0==t.organizationStore.items.length?"加载中...":"":"未经授权, 请联系管理员"},on:{"on-select-change":t.handleSelectChange}})],1),e("Col",{attrs:{span:"16"}},[e("Form",{ref:"organizationForm",attrs:{model:t.organizationForm,rules:t.ruleValidate,"label-width":80}},[e("Row",[e("Col",{attrs:{span:"8"}},[e("Form-item",{attrs:{label:"名称",prop:"name"}},[e("Input",{attrs:{size:"small",placeholder:"请输入名称"},model:{value:t.organizationForm.name,callback:function(e){t.$set(t.organizationForm,"name",e)},expression:"organizationForm.name"}})],1)],1),e("Col",{attrs:{span:"8"}},[e("Form-item",{attrs:{label:"编码",prop:"code"}},[e("Input",{attrs:{size:"small",placeholder:"请输入编码"},model:{value:t.organizationForm.code,callback:function(e){t.$set(t.organizationForm,"code",e)},expression:"organizationForm.code"}})],1)],1)],1),e("Row",[e("Col",{attrs:{span:"8"}},[e("Form-item",{attrs:{label:"父节点",prop:"pname"}},[e("Input",{attrs:{size:"small",placeholder:"请输入名称",readonly:""},model:{value:t.organizationForm.pname,callback:function(e){t.$set(t.organizationForm,"pname",e)},expression:"organizationForm.pname"}})],1)],1),e("Col",{attrs:{span:"8"}},[e("Form-item",{attrs:{label:"排序号",prop:"sort"}},[e("Input",{attrs:{size:"small",placeholder:"请输入排序号"},model:{value:t.organizationForm.sort,callback:function(e){t.$set(t.organizationForm,"sort",e)},expression:"organizationForm.sort"}})],1)],1)],1),e("Row",[e("Col",{attrs:{span:"16"}},[e("Form-item",{attrs:{label:"叶子节点",prop:"isLeaf"}},[e("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.organizationForm.isLeaf,callback:function(e){t.$set(t.organizationForm,"isLeaf",e)},expression:"organizationForm.isLeaf"}})],1)],1)],1),e("Row",[e("Col",{attrs:{span:"16"}},[e("Form-item",{attrs:{label:"备注",prop:"remark"}},[e("Input",{attrs:{type:"textarea",size:"small",placeholder:"请输入备注"},model:{value:t.organizationForm.remark,callback:function(e){t.$set(t.organizationForm,"remark",e)},expression:"organizationForm.remark"}})],1)],1)],1),e("FormItem",[e("Button",{attrs:{type:"default",size:"small"},on:{click:t.handleCancel}},[t._v(t._s(t.cancelText))]),""!==t.organizationForm.id&&t.options.modify||""===t.organizationForm.id&&t.options.add?e("Button",{attrs:{type:"primary",size:"small",loading:t.modifyLoading},on:{click:t.handleOk}},[(t.modifyLoading,e("span",[t._v(t._s(t.okText))]))]):t._e()],1),e("Form-item",{attrs:{prop:"id"}})],1)],1)],1)],1)],1)},i=[],n=o("2f62"),r=function(){var t=this,e=t._self._c;return e("div",[e("Modal",{attrs:{width:"300"},on:{"on-cancel":t.handleCancel},model:{value:t.removeModal,callback:function(e){t.removeModal=e},expression:"removeModal"}},[e("p",{staticStyle:{color:"#f60"},attrs:{slot:"header"},slot:"header"},[e("Icon",{attrs:{type:"information-circled"}}),e("span",[t._v(t._s(t.title))])],1),e("div",{staticStyle:{"text-align":"center"}},[e("p",[t._v("确认删除该记录？")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"error",size:"small",long:"",loading:t.removeLoading},on:{click:t.handleOk}},[(t.removeLoading,e("span",[t._v(t._s(t.okText))]))])],1)])],1)},s=[],l={name:"removeModal",props:{id:{type:String,default:""},modal:{type:Boolean,default:!1},title:{type:String,default:"机构删除"},okText:{type:String,default:"确认"}},data:function(){return{removeModal:!1,removeLoading:!1,removeForm:{id:""}}},watch:{modal:function(t){t&&""!==this.id&&(this.removeForm.id=this.id,this.removeModal=t)},removeModal:function(t){t||this.$emit("on-modal-change","",t)}},methods:{handleOk:function(){var t=this;this.removeLoading=!0,this.$store.dispatch("removeOrganization",{data:{id:this.removeForm.id}}).then((function(){t.handleCancel(),t.$Message.success(t.title+"成功！"),t.$emit("on-refresh-page")}),(function(e){t.handleCancel(),t.$Message.error(e.data.message)}))},handleCancel:function(){this.removeForm.id="",this.removeModal=!1,this.removeLoading=!1}}},d=l,m=o("2877"),h=Object(m["a"])(d,r,s,!1,null,null,null),p=h.exports,g={name:"organization",props:{okText:{type:String,default:"确定"},cancelText:{type:String,default:"取消"}},components:{RemoveModal:p},data:function(){return{modifyLoading:!1,modal:{id:"",remove:!1},options:{page:!1,add:!0,modify:!1,show:!1,remove:!1,removeDisabled:!0},organizationForm:{id:"",name:"",code:"",remark:"",pid:"",pname:"",sort:0,isLeaf:0},ruleValidate:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{type:"string",max:10,message:"名称不能多于10个字符",trigger:"blur"}],code:[{required:!0,message:"编码不能为空",trigger:"blur"},{type:"string",max:10,message:"编码不能多于10个字符",trigger:"blur"}]}}},computed:Object(n["e"])(["organizationStore","loginStore"]),created:function(){this.loginStore.menuOptionMap[this.$route.path]&&this.initOptionsStatus()},mounted:function(){this.options.page&&this.handlePageChange()},methods:{initOptionsStatus:function(){this.options.page=-1!==this.loginStore.menuOptionMap[this.$route.path].indexOf("YHGL:ZZJG:CX"),this.options.add=-1!==this.loginStore.menuOptionMap[this.$route.path].indexOf("YHGL:ZZJG:XZ"),this.options.modify=-1!==this.loginStore.menuOptionMap[this.$route.path].indexOf("YHGL:ZZJG:BJ"),this.options.show=-1!==this.loginStore.menuOptionMap[this.$route.path].indexOf("YHGL:ZZJG:CK"),this.options.remove=-1!==this.loginStore.menuOptionMap[this.$route.path].indexOf("YHGL:ZZJG:SC")},listOrganization:function(){this.$store.dispatch("listOrganization")},showOrganization:function(){var t=this;this.$store.dispatch("showOrganization",{params:{id:this.organizationForm.id}}).then((function(){t.organizationForm=t.organizationStore.item}))},handleSelectChange:function(t){t.length>0?(this.options.removeDisabled=!1,this.organizationForm.id=t[0].id,this.showOrganization()):(this.options.removeDisabled=!0,this.organizationForm.id="",this.resetFields())},handleRefreshChange:function(t){t&&this.resetFields(),this.handlePageChange()},handlePageChange:function(){this.listOrganization()},handleRemoveModalChange:function(t,e){this.modal.id=t,this.modal.remove=e},handleOk:function(){var t=this;this.$refs.organizationForm.validate((function(e){e&&(t.modifyLoading=!0,t.$store.dispatch(""===t.organizationForm.id?"addOrganization":"modifyOrganization",{data:t.organizationForm}).then((function(){t.$Message.success((""===t.organizationForm.id?"机构新增":"机构编辑")+"成功！"),t.handleCancel(),t.handlePageChange()}),(function(e){t.modifyLoading=!1,t.$Message.error(e.data.message)})))}))},handleCancel:function(){this.resetFields(),this.modifyLoading=!1},resetFields:function(){this.$refs.organizationForm.resetFields()},handleAddButtonClick:function(){this.resetFields();var t=this.$refs.organizationTree.getSelectedNodes();1===t.length&&(this.organizationForm.pid=t[0].id,this.organizationForm.pname=t[0].title)},handleRemoveButtonClick:function(){this.resetFields();var t=this.$refs.organizationTree.getSelectedNodes();1===t.length&&(this.modal.id=t[0].id,this.modal.remove=!0)}}},c=g,u=Object(m["a"])(c,a,i,!1,null,null,null);e["default"]=u.exports}}]);