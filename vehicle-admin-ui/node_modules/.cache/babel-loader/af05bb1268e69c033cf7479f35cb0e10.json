{"remainingRequest":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/thread-loader/dist/cjs.js!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/babel-loader/lib/index.js!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/eslint-loader/index.js??ref--13-0!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/utils/rest.js","dependencies":[{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/utils/rest.js","mtime":1734063882336},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/.babelrc","mtime":1734230871032},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1734234711738},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/thread-loader/dist/cjs.js","mtime":1734234711278},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/babel-loader/lib/index.js","mtime":1734234712752},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/eslint-loader/index.js","mtime":1734234711712}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport _defineProperty from \"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _typeof from \"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/@babel/runtime-corejs2/helpers/esm/typeof.js\";\nimport _classCallCheck from \"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/@babel/runtime-corejs2/helpers/esm/createClass.js\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport axios from 'axios';\nimport qs from 'qs';\nimport router from \"../router\";\nimport store from '@/store';\nimport consts from '@/utils/consts';\n\n/**\n * 基于 axios 的 RESTful HTTP 简单封装\n */\n// 请求超时配置\naxios.defaults.timeout = 100000;\n\n// 添加一个响应拦截器\naxios.interceptors.response.use(function (response) {\n  if (response.headers['oauthstatus'] === '401') {\n    // 退出登录\n    store.commit('setToken', '');\n    store.commit('setAccess', []);\n    store.commit('setHasGetInfo', false);\n    router.push({\n      name: 'login'\n    });\n  }\n  return response;\n});\nvar REST = /*#__PURE__*/function () {\n  /**\n   * 构造方法\n   */\n  function REST() {\n    var _this = this;\n    _classCallCheck(this, REST);\n    /**\n     * 接口基础地址\n     * @type {string}\n     */\n    this.baseURL = '';\n\n    /**\n     * 接口版本\n     * @type {string}\n     */\n    this.version = '';\n\n    /**\n     * 请求路劲\n     * @type {string}\n     */\n    this.path = '';\n\n    /**\n     * Headers\n     * @type {Object}\n     */\n    this.headers = {\n      'X-Requested-with': 'XMLHttpRequest'\n    };\n\n    /**\n     * 统一错误处理\n     * @type {Function}\n     */\n    this.errorHandler = function () {};\n\n    // 支持的请求方式\n    var methods = ['GET', 'POST', 'PATCH', 'PUT', 'DELETE'];\n\n    // 注册方法到 this\n    methods.forEach(function (method) {\n      _this[method] = function (options) {\n        return _this._request(method, options);\n      };\n    });\n  }\n\n  /**\n   * 请求\n   * @param {string} method='GET' 请求方式\n   * @param {Object} [options={}] 选项\n   * @param {string} [options.uri=''] 资源唯一标示，一般是 ID\n   * @param {Object} [options.params=null] GET 参数\n   * @param {Object} [options.data=null] POST/PUT/PATCH 数据\n   * @return {Object}\n   */\n  return _createClass(REST, [{\n    key: \"_request\",\n    value: function _request() {\n      var _this2 = this;\n      var method = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'GET';\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var _options$uri = options.uri,\n        uri = _options$uri === void 0 ? '' : _options$uri,\n        _options$params = options.params,\n        params = _options$params === void 0 ? null : _options$params,\n        _options$data = options.data,\n        data = _options$data === void 0 ? null : _options$data,\n        _options$contentType = options.contentType,\n        contentType = _options$contentType === void 0 ? consts.FORM_CONTENT_TYPE : _options$contentType;\n      var url = this.version ? \"/\".concat(this.version, \"/\").concat(this.path) : \"/\".concat(this.path);\n      if (uri) {\n        url = \"\".concat(url, \"/\").concat(uri);\n      }\n\n      // GET\n      if (params) {\n        var cleanedParams = this._cleanParams(params);\n        url = url + this._objToUrl(cleanedParams);\n      }\n\n      // POST\n      var formData = {};\n      if (data) {\n        var cleanedData = this._cleanParams(data);\n        if (contentType === consts.FORM_CONTENT_TYPE) {\n          formData = qs.stringify(cleanedData);\n        } else {\n          formData = JSON.stringify(cleanedData);\n        }\n      }\n      this.addHeaders({\n        'Content-Type': contentType\n      });\n      return new Promise(function (resolve, reject) {\n        axios({\n          baseURL: _this2.baseURL,\n          headers: _this2.headers,\n          method: method,\n          url: url,\n          data: formData,\n          withCredentials: true\n        }).then(function (res) {\n          if (_typeof(res.data) === 'object') {\n            if (res.data.code === 200 && res.data.data.message === 'success') {\n              resolve(res.data);\n            } else if (res.data.code === 200 && res.data.data.message === '未查找到记录') {\n              resolve(res.data);\n            } else if (res.data.code === 406) {\n              throw new Error(res.data.data.message);\n            } else {\n              reject(res.data);\n            }\n          }\n        }).catch(_this2.errorHandler);\n      });\n    }\n\n    /**\n     * 清洗参数对象(清洗参数中空字符串)\n     *\n     * @param {Object} obj 待转化对象\n     * @return {string}\n     */\n  }, {\n    key: \"_cleanParams\",\n    value: function _cleanParams(obj) {\n      var cleanedParams = {};\n      if (!obj || !Object.keys(obj).length) {\n        return cleanedParams;\n      }\n      Object.keys(obj).map(function (key) {\n        if (obj[key] !== undefined && obj[key] !== null && obj[key] !== '') {\n          Object.assign(cleanedParams, _defineProperty({}, key, obj[key]));\n        }\n      });\n      return cleanedParams;\n    }\n\n    /**\n     * 对象转 URL\n     * @param {Object} obj 待转化对象\n     * @return {string}\n     */\n  }, {\n    key: \"_objToUrl\",\n    value: function _objToUrl(obj) {\n      if (!obj || !Object.keys(obj).length) {\n        return '';\n      }\n      return '?' + Object.keys(obj).map(function (key) {\n        return \"\".concat(key, \"=\").concat(encodeURIComponent(obj[key]));\n      }).join('&');\n    }\n\n    /**\n     * 附加路径\n     * @param {string} [path=''] 路径\n     */\n  }, {\n    key: \"addPath\",\n    value: function addPath() {\n      var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      this.path = this.path === '' ? path : this.path + '/' + path;\n      return this;\n    }\n\n    /**\n     * 添加 Headers\n     * @param {Object} headers Headers\n     */\n  }, {\n    key: \"addHeaders\",\n    value: function addHeaders(headers) {\n      this.headers = _objectSpread(_objectSpread({}, this.headers), headers);\n      return this;\n    }\n\n    /**\n     * 路径参数替换\n     * @param {Object} options={} 路劲参数列表\n     */\n  }, {\n    key: \"replace\",\n    value: function replace() {\n      var _this3 = this;\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      Object.keys(options).forEach(function (key) {\n        _this3.path = _this3.path.replace(new RegExp('{' + key + '}', 'img'), options[key]);\n      });\n      return this;\n    }\n  }]);\n}();\nexport { REST as default };",null]}