{"remainingRequest":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/thread-loader/dist/cjs.js!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/babel-loader/lib/index.js!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/eslint-loader/index.js??ref--13-0!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/store/modules/iviewAdmin/user/actions.js","dependencies":[{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/store/modules/iviewAdmin/user/actions.js","mtime":1734063882615},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/.babelrc","mtime":1734230871032},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1734234711738},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/thread-loader/dist/cjs.js","mtime":1734234711278},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/babel-loader/lib/index.js","mtime":1734234712752},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/eslint-loader/index.js","mtime":1734234711712}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.function.name\";\nimport { getContentByMsgId as _getContentByMsgId, getMessage, getUnreadCount, getUserInfo as _getUserInfo, hasRead as _hasRead, login, logout, removeReaded as _removeReaded, restoreTrash as _restoreTrash } from '@/api/user';\nexport default {\n  // 登录\n  handleLogin: function handleLogin(_ref, _ref2) {\n    var commit = _ref.commit;\n    var userName = _ref2.userName,\n      password = _ref2.password;\n    userName = userName.trim();\n    return new Promise(function (resolve, reject) {\n      login({\n        userName: userName,\n        password: password\n      }).then(function (res) {\n        var data = res.data;\n        commit('setToken', data.token);\n        resolve();\n      }).catch(function (err) {\n        reject(err);\n      });\n    });\n  },\n  // 退出登录\n  handleLogOut: function handleLogOut(_ref3) {\n    var state = _ref3.state,\n      commit = _ref3.commit;\n    return new Promise(function (resolve, reject) {\n      logout(state.token).then(function () {\n        commit('setToken', '');\n        commit('setAccess', []);\n        resolve();\n      }).catch(function (err) {\n        reject(err);\n      });\n      // 如果你的退出登录无需请求接口，则可以直接使用下面三行代码而无需使用logout调用接口\n      // commit('setToken', '')\n      // commit('setAccess', [])\n      // resolve()\n    });\n  },\n  // 获取用户相关信息\n  getUserInfo: function getUserInfo(_ref4) {\n    var state = _ref4.state,\n      commit = _ref4.commit;\n    return new Promise(function (resolve, reject) {\n      try {\n        _getUserInfo(state.token).then(function (res) {\n          var data = res.data;\n          commit('setAvatar', data.avatar);\n          commit('setUserName', data.name);\n          commit('setUserId', data.user_id);\n          commit('setAccess', data.access);\n          commit('setHasGetInfo', true);\n          resolve(data);\n        }).catch(function (err) {\n          reject(err);\n        });\n      } catch (error) {\n        reject(error);\n      }\n    });\n  },\n  // 此方法用来获取未读消息条数，接口只返回数值，不返回消息列表\n  getUnreadMessageCount: function getUnreadMessageCount(_ref5) {\n    var state = _ref5.state,\n      commit = _ref5.commit;\n    getUnreadCount().then(function (res) {\n      var data = res.data;\n      commit('setMessageCount', data);\n    });\n  },\n  // 获取消息列表，其中包含未读、已读、回收站三个列表\n  getMessageList: function getMessageList(_ref6) {\n    var state = _ref6.state,\n      commit = _ref6.commit;\n    return new Promise(function (resolve, reject) {\n      getMessage().then(function (res) {\n        var _res$data = res.data,\n          unread = _res$data.unread,\n          readed = _res$data.readed,\n          trash = _res$data.trash;\n        commit('setMessageUnreadList', unread.sort(function (a, b) {\n          return new Date(b.create_time) - new Date(a.create_time);\n        }));\n        commit('setMessageReadedList', readed.map(function (_) {\n          _.loading = false;\n          return _;\n        }).sort(function (a, b) {\n          return new Date(b.create_time) - new Date(a.create_time);\n        }));\n        commit('setMessageTrashList', trash.map(function (_) {\n          _.loading = false;\n          return _;\n        }).sort(function (a, b) {\n          return new Date(b.create_time) - new Date(a.create_time);\n        }));\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // 根据当前点击的消息的id获取内容\n  getContentByMsgId: function getContentByMsgId(_ref7, _ref8) {\n    var state = _ref7.state,\n      commit = _ref7.commit;\n    var msg_id = _ref8.msg_id;\n    return new Promise(function (resolve, reject) {\n      var contentItem = state.messageContentStore[msg_id];\n      if (contentItem) {\n        resolve(contentItem);\n      } else {\n        _getContentByMsgId(msg_id).then(function (res) {\n          var content = res.data;\n          commit('updateMessageContentStore', {\n            msg_id: msg_id,\n            content: content\n          });\n          resolve(content);\n        });\n      }\n    });\n  },\n  // 把一个未读消息标记为已读\n  hasRead: function hasRead(_ref9, _ref10) {\n    var state = _ref9.state,\n      commit = _ref9.commit;\n    var msg_id = _ref10.msg_id;\n    return new Promise(function (resolve, reject) {\n      _hasRead(msg_id).then(function () {\n        commit('moveMsg', {\n          from: 'messageUnreadList',\n          to: 'messageReadedList',\n          msg_id: msg_id\n        });\n        commit('setMessageCount', state.unreadCount - 1);\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // 删除一个已读消息到回收站\n  removeReaded: function removeReaded(_ref11, _ref12) {\n    var commit = _ref11.commit;\n    var msg_id = _ref12.msg_id;\n    return new Promise(function (resolve, reject) {\n      _removeReaded(msg_id).then(function () {\n        commit('moveMsg', {\n          from: 'messageReadedList',\n          to: 'messageTrashList',\n          msg_id: msg_id\n        });\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  // 还原一个已删除消息到已读消息\n  restoreTrash: function restoreTrash(_ref13, _ref14) {\n    var commit = _ref13.commit;\n    var msg_id = _ref14.msg_id;\n    return new Promise(function (resolve, reject) {\n      _restoreTrash(msg_id).then(function () {\n        commit('moveMsg', {\n          from: 'messageTrashList',\n          to: 'messageReadedList',\n          msg_id: msg_id\n        });\n        resolve();\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  }\n};",null]}