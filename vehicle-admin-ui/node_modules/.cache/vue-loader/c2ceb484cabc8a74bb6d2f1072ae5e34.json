{"remainingRequest":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/views/excel/upload-excel.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/views/excel/upload-excel.vue","mtime":1734063882490},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/babel-loader/lib/index.js","mtime":1734234712752},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1734234711738},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/vue-loader/lib/index.js","mtime":1734234711707}],"contextDependencies":[],"result":["\n  import excel from '@/libs/excel'\n\n  export default {\n    name: 'upload-excel',\n    data () {\n      return {\n        uploadLoading: false,\n        progressPercent: 0,\n        showProgress: false,\n        showRemoveFile: false,\n        file: null,\n        tableData: [],\n        tableTitle: [],\n        tableLoading: false\n      }\n    },\n    methods: {\n      initUpload () {\n        this.file = null\n        this.showProgress = false\n        this.loadingProgress = 0\n        this.tableData = []\n        this.tableTitle = []\n      },\n      handleUploadFile () {\n        this.initUpload()\n      },\n      handleRemove () {\n        this.initUpload()\n        this.$Message.info('上传的文件已删除！')\n      },\n      handleBeforeUpload (file) {\n        const fileExt = file.name.split('.').pop().toLocaleLowerCase()\n        if (fileExt === 'xlsx' || fileExt === 'xls') {\n          this.readFile(file)\n          this.file = file\n        } else {\n          this.$Notice.warning({\n            title: '文件类型错误',\n            desc: '文件：' + file.name + '不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。'\n          })\n        }\n        return false\n      },\n      // 读取文件\n      readFile (file) {\n        const reader = new FileReader()\n        reader.readAsArrayBuffer(file)\n        reader.onloadstart = e => {\n          this.uploadLoading = true\n          this.tableLoading = true\n          this.showProgress = true\n        }\n        reader.onprogress = e => {\n          this.progressPercent = Math.round(e.loaded / e.total * 100)\n        }\n        reader.onerror = e => {\n          this.$Message.error('文件读取出错')\n        }\n        reader.onload = e => {\n          this.$Message.info('文件读取成功')\n          const data = e.target.result\n          const { header, results } = excel.read(data, 'array')\n          const tableTitle = header.map(item => { return { title: item, key: item } })\n          this.tableData = results\n          this.tableTitle = tableTitle\n          this.uploadLoading = false\n          this.tableLoading = false\n          this.showRemoveFile = true\n        }\n      }\n    },\n    created () {\n\n    },\n    mounted () {\n\n    }\n  }\n",null]}