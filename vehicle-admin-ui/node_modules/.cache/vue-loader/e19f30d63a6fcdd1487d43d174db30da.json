{"remainingRequest":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/components/main/main.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/src/components/main/main.vue","mtime":1734063882405},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1734234711738},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/babel-loader/lib/index.js","mtime":1734234712752},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1734234711738},{"path":"/Users/TaoBangren/gitee/finhub-vehicle/vehicle-admin-ui/node_modules/vue-loader/lib/index.js","mtime":1734234711707}],"contextDependencies":[],"result":["\n  import SideMenu from './components/side-menu'\n  import HeaderBar from './components/header-bar'\n  import TagsNav from './components/tags-nav'\n  import User from './components/user'\n  import ABackTop from './components/a-back-top'\n  import Fullscreen from './components/fullscreen'\n  import Language from './components/language'\n  import ErrorStore from './components/error-store'\n  import config from '@/config'\n  import { mapMutations, mapActions, mapGetters, mapState } from 'vuex'\n  import { getNewTagList, routeEqual, setMenuItemsInSessionstorage, getMenuItemsFromSessionstorage} from '@/libs/util'\n  import { iviewAdminRouter } from '@/router/iviewAdmin'\n  import minLogo from '@/assets/images/logo-min.jpg'\n  import maxLogo from '@/assets/images/logo.jpg'\n  import './main.less'\n\n  export default {\n    name: 'Main',\n    components: {\n      SideMenu,\n      HeaderBar,\n      Language,\n      TagsNav,\n      Fullscreen,\n      ErrorStore,\n      User,\n      ABackTop\n    },\n    data () {\n      return {\n        menuItems: [],\n        collapsed: false,\n        minLogo,\n        maxLogo,\n        isFullscreen: false\n      }\n    },\n    computed: {\n      ...mapState([\n        'iviewAdminAppStore',\n        'iviewAdminUserStore'\n      ]),\n      ...mapGetters([\n        'menuList',\n        'errorCount'\n      ]),\n      tagNavList () {\n        return this.iviewAdminAppStore.tagNavList\n      },\n//      tagRouter () {\n//        return this.iviewAdminAppStore.tagRouter\n//      },\n      userAvatar () {\n        return this.iviewAdminUserStore.avatarImgPath\n      },\n      cacheList () {\n        const list = ['ParentView', ...this.tagNavList.length ? this.tagNavList.filter(item => !(item.meta && item.meta.notCache)).map(item => item.name) : []]\n        return list\n      },\n      local () {\n        return this.iviewAdminAppStore.local\n      },\n      hasReadErrorPage () {\n        return this.iviewAdminAppStore.hasReadErrorPage\n      },\n      unreadCount () {\n        return this.iviewAdminUserStore.unreadCount\n      }\n    },\n    methods: {\n      ...mapMutations([\n        'setBreadCrumb',\n        'setTagNavList',\n        'addTag',\n        'setLocal',\n        'setHomeRoute',\n        'closeTag'\n      ]),\n      ...mapActions([\n        'listUserMenu',\n        'handleLogin',\n        'getUnreadMessageCount'\n      ]),\n      turnToPage (route) {\n        let { name, params, query } = {}\n        if (typeof route === 'string') name = route\n        else {\n          name = route.name\n          params = route.params\n          query = route.query\n        }\n        if (name.indexOf('isTurnByHref_') > -1) {\n          window.open(name.split('_')[1])\n          return\n        }\n        this.$router.push({\n          name,\n          params,\n          query\n        })\n      },\n      handleCollapsedChange (state) {\n        this.collapsed = state\n      },\n      handleCloseTag (res, type, route) {\n        if (type !== 'others') {\n          if (type === 'all') {\n            this.turnToPage(this.$config.homeName)\n          } else {\n            if (routeEqual(this.$route, route)) {\n              this.closeTag(route)\n            }\n          }\n        }\n        this.setTagNavList(res)\n      },\n      handleClick (item) {\n        this.turnToPage(item)\n      }\n    },\n    watch: {\n      '$route' (newRoute) {\n        const { name, query, params, meta } = newRoute\n        this.addTag({\n          route: { name, query, params, meta },\n          type: 'push'\n        })\n        this.setBreadCrumb(newRoute)\n        this.setTagNavList(getNewTagList(this.tagNavList, newRoute))\n        this.$refs.sideMenu.updateOpenName(newRoute.name)\n      }\n    },\n    mounted () {\n      /**\n       * @description 初始化设置面包屑导航和标签导航\n       */\n      this.setTagNavList()\n      this.setHomeRoute(iviewAdminRouter)\n      const { name, params, query, meta } = this.$route\n      this.addTag({\n        route: { name, params, query, meta }\n      })\n      this.setBreadCrumb(this.$route)\n      // 设置初始语言\n      this.setLocal(this.$i18n.locale)\n      // 如果当前打开页面不在标签栏中，跳到homeName页\n      if (!this.tagNavList.find(item => item.name === this.$route.name)) {\n        this.$router.push({\n          name: this.$config.homeName\n        })\n      }\n      // 获取未读消息条数\n      this.getUnreadMessageCount()\n\n      // 获取当前用户菜单权限\n      if (config.checkUserMenu) {\n        this.menuItems = getMenuItemsFromSessionstorage()\n        if (Object.keys(this.menuItems).length <= 0) {\n          this.listUserMenu().then(() => {\n            this.menuItems = this.menuList\n            setMenuItemsInSessionstorage(this.menuItems)\n          })\n        }\n      } else {\n        this.menuItems = this.menuList\n      }\n    }\n  }\n",{"version":3,"sources":["main.vue"],"names":[],"mappings":";AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.vue","sourceRoot":"src/components/main","sourcesContent":["<template>\n  <Layout style=\"height: 100%\" class=\"main\">\n    <Sider hide-trigger collapsible :width=\"256\" :collapsed-width=\"64\" v-model=\"collapsed\" class=\"left-sider\"\n           :style=\"{overflow: 'hidden'}\">\n      <side-menu accordion ref=\"sideMenu\" :active-name=\"$route.name\" :collapsed=\"collapsed\" @on-select=\"turnToPage\"\n                 :menu-list=\"menuItems\">\n        <!-- 需要放在菜单上面的内容，如Logo，写在side-menu标签内部，如下 -->\n        <div class=\"logo-con\">\n          <img v-show=\"!collapsed\" :src=\"maxLogo\" key=\"max-logo\"/>\n          <img v-show=\"collapsed\" :src=\"minLogo\" key=\"min-logo\"/>\n        </div>\n      </side-menu>\n    </Sider>\n    <Layout>\n      <Header class=\"header-con\">\n        <header-bar :collapsed=\"collapsed\" @on-coll-change=\"handleCollapsedChange\">\n          <user :message-unread-count=\"unreadCount\" :user-avatar=\"userAvatar\"/>\n          <language v-if=\"$config.useI18n\" @on-lang-change=\"setLocal\" style=\"margin-right: 10px;\" :lang=\"local\"/>\n          <error-store v-if=\"$config.plugin['error-store'] && $config.plugin['error-store'].showInHeader\"\n                       :has-read=\"hasReadErrorPage\" :count=\"errorCount\"></error-store>\n          <fullscreen v-model=\"isFullscreen\" style=\"margin-right: 10px;\"/>\n        </header-bar>\n      </Header>\n      <Content class=\"main-content-con\">\n        <Layout class=\"main-layout-con\">\n          <div class=\"tag-nav-wrapper\">\n            <tags-nav :value=\"$route\" @input=\"handleClick\" :list=\"tagNavList\" @on-close=\"handleCloseTag\"/>\n          </div>\n          <Content class=\"content-wrapper\">\n            <keep-alive :include=\"cacheList\">\n              <router-view/>\n            </keep-alive>\n            <ABackTop :height=\"100\" :bottom=\"80\" :right=\"50\" container=\".content-wrapper\"></ABackTop>\n          </Content>\n        </Layout>\n      </Content>\n    </Layout>\n  </Layout>\n</template>\n<script>\n  import SideMenu from './components/side-menu'\n  import HeaderBar from './components/header-bar'\n  import TagsNav from './components/tags-nav'\n  import User from './components/user'\n  import ABackTop from './components/a-back-top'\n  import Fullscreen from './components/fullscreen'\n  import Language from './components/language'\n  import ErrorStore from './components/error-store'\n  import config from '@/config'\n  import { mapMutations, mapActions, mapGetters, mapState } from 'vuex'\n  import { getNewTagList, routeEqual, setMenuItemsInSessionstorage, getMenuItemsFromSessionstorage} from '@/libs/util'\n  import { iviewAdminRouter } from '@/router/iviewAdmin'\n  import minLogo from '@/assets/images/logo-min.jpg'\n  import maxLogo from '@/assets/images/logo.jpg'\n  import './main.less'\n\n  export default {\n    name: 'Main',\n    components: {\n      SideMenu,\n      HeaderBar,\n      Language,\n      TagsNav,\n      Fullscreen,\n      ErrorStore,\n      User,\n      ABackTop\n    },\n    data () {\n      return {\n        menuItems: [],\n        collapsed: false,\n        minLogo,\n        maxLogo,\n        isFullscreen: false\n      }\n    },\n    computed: {\n      ...mapState([\n        'iviewAdminAppStore',\n        'iviewAdminUserStore'\n      ]),\n      ...mapGetters([\n        'menuList',\n        'errorCount'\n      ]),\n      tagNavList () {\n        return this.iviewAdminAppStore.tagNavList\n      },\n//      tagRouter () {\n//        return this.iviewAdminAppStore.tagRouter\n//      },\n      userAvatar () {\n        return this.iviewAdminUserStore.avatarImgPath\n      },\n      cacheList () {\n        const list = ['ParentView', ...this.tagNavList.length ? this.tagNavList.filter(item => !(item.meta && item.meta.notCache)).map(item => item.name) : []]\n        return list\n      },\n      local () {\n        return this.iviewAdminAppStore.local\n      },\n      hasReadErrorPage () {\n        return this.iviewAdminAppStore.hasReadErrorPage\n      },\n      unreadCount () {\n        return this.iviewAdminUserStore.unreadCount\n      }\n    },\n    methods: {\n      ...mapMutations([\n        'setBreadCrumb',\n        'setTagNavList',\n        'addTag',\n        'setLocal',\n        'setHomeRoute',\n        'closeTag'\n      ]),\n      ...mapActions([\n        'listUserMenu',\n        'handleLogin',\n        'getUnreadMessageCount'\n      ]),\n      turnToPage (route) {\n        let { name, params, query } = {}\n        if (typeof route === 'string') name = route\n        else {\n          name = route.name\n          params = route.params\n          query = route.query\n        }\n        if (name.indexOf('isTurnByHref_') > -1) {\n          window.open(name.split('_')[1])\n          return\n        }\n        this.$router.push({\n          name,\n          params,\n          query\n        })\n      },\n      handleCollapsedChange (state) {\n        this.collapsed = state\n      },\n      handleCloseTag (res, type, route) {\n        if (type !== 'others') {\n          if (type === 'all') {\n            this.turnToPage(this.$config.homeName)\n          } else {\n            if (routeEqual(this.$route, route)) {\n              this.closeTag(route)\n            }\n          }\n        }\n        this.setTagNavList(res)\n      },\n      handleClick (item) {\n        this.turnToPage(item)\n      }\n    },\n    watch: {\n      '$route' (newRoute) {\n        const { name, query, params, meta } = newRoute\n        this.addTag({\n          route: { name, query, params, meta },\n          type: 'push'\n        })\n        this.setBreadCrumb(newRoute)\n        this.setTagNavList(getNewTagList(this.tagNavList, newRoute))\n        this.$refs.sideMenu.updateOpenName(newRoute.name)\n      }\n    },\n    mounted () {\n      /**\n       * @description 初始化设置面包屑导航和标签导航\n       */\n      this.setTagNavList()\n      this.setHomeRoute(iviewAdminRouter)\n      const { name, params, query, meta } = this.$route\n      this.addTag({\n        route: { name, params, query, meta }\n      })\n      this.setBreadCrumb(this.$route)\n      // 设置初始语言\n      this.setLocal(this.$i18n.locale)\n      // 如果当前打开页面不在标签栏中，跳到homeName页\n      if (!this.tagNavList.find(item => item.name === this.$route.name)) {\n        this.$router.push({\n          name: this.$config.homeName\n        })\n      }\n      // 获取未读消息条数\n      this.getUnreadMessageCount()\n\n      // 获取当前用户菜单权限\n      if (config.checkUserMenu) {\n        this.menuItems = getMenuItemsFromSessionstorage()\n        if (Object.keys(this.menuItems).length <= 0) {\n          this.listUserMenu().then(() => {\n            this.menuItems = this.menuList\n            setMenuItemsInSessionstorage(this.menuItems)\n          })\n        }\n      } else {\n        this.menuItems = this.menuList\n      }\n    }\n  }\n</script>\n"]}]}